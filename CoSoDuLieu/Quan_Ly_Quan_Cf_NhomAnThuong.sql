--ĐỀ TÀI THỰC TẬP "PHẦN MỀM QUẢN LÝ QUÁN CÀ PHÊ"
--TRẦN THANH AN, VŨ THỊ THƯƠNG

--TẠO BẢNG
CREATE DATABASE QuanLyQuanCf
GO
USE QuanLyQuanCf

GO
CREATE TABLE CHUCVU(
	MACHUCVU VARCHAR(10) NOT NULL PRIMARY KEY,
	TENCHUCVU NVARCHAR(20) NOT NULL
)

GO
CREATE TABLE CA(
	MACA VARCHAR(2) NOT NULL PRIMARY KEY,
	TENCA NVARCHAR(10) NOT NULL
)

GO
CREATE TABLE CHITIETCA(
	NGAYLAMVIEC DATE NOT NULL,
	MACA VARCHAR(2) NOT NULL,
	TRANGTHAI BIT NULL DEFAULT 0,
	PRIMARY KEY(NGAYLAMVIEC, MACA),
	CONSTRAINT FK_CA FOREIGN KEY (MACA) REFERENCES CA(MACA) ON DELETE CASCADE,
)

GO
CREATE TABLE NHANVIEN(
	MANV VARCHAR(10) NOT NULL PRIMARY KEY, --Làm tên tài khoản đăng nhập nhân viên
	TENNV NVARCHAR(50) NOT NULL,
	NGAYSINH DATE NOT NULL,
	GIOITINH NVARCHAR(5) NOT NULL,
	DIACHI NVARCHAR(100) NOT NULL,
	DIENTHOAI VARCHAR(11) NOT NULL,
	MATKHAU VARCHAR(35) NOT NULL,
	MACHUCVU VARCHAR(10) NOT NULL FOREIGN KEY REFERENCES CHUCVU(MACHUCVU),
	NGAYVAOLAM DATE NOT NULL,
	MACA VARCHAR(2) NULL FOREIGN KEY (MACA) REFERENCES CA(MACA) ON DELETE SET NULL,
	LUONGCOBAN MONEY NOT NULL
)

GO
CREATE TABLE CHAMCONG(
	MACHAMCONG INT IDENTITY(1,1) PRIMARY KEY,
	THANG VARCHAR(2) NOT NULL,
	NAM VARCHAR(4) NOT NULL,
)


GO
CREATE TABLE CHAMCONGCHITIET(
	MACHAMCONG INT NOT NULL,
	MANV VARCHAR(10) NOT NULL,
	TONGCONG INT NULL DEFAULT 0,
	PRIMARY KEY (MACHAMCONG, MANV),
	CONSTRAINT FK_CCCT FOREIGN KEY (MACHAMCONG) REFERENCES CHAMCONG(MACHAMCONG) ON DELETE CASCADE,
	CONSTRAINT FK_CCCT_NV FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV) ON DELETE CASCADE,
	N1 tinyint NULL DEFAULT 0,
	N2 tinyint NULL DEFAULT 0,
	N3 tinyint NULL DEFAULT 0,
	N4 tinyint NULL DEFAULT 0,
	N5 tinyint NULL DEFAULT 0,
	N6 tinyint NULL DEFAULT 0,
	N7 tinyint NULL DEFAULT 0,
	N8 tinyint NULL DEFAULT 0,
	N9 tinyint NULL DEFAULT 0,
	N10 tinyint NULL DEFAULT 0,
	N11 tinyint NULL DEFAULT 0,
	N12 tinyint NULL DEFAULT 0,
	N13 tinyint NULL DEFAULT 0,
	N14 tinyint NULL DEFAULT 0,
	N15 tinyint NULL DEFAULT 0,
	N16 tinyint NULL DEFAULT 0,
	N17 tinyint NULL DEFAULT 0,
	N18 tinyint NULL DEFAULT 0,
	N19 tinyint NULL DEFAULT 0,
	N20 tinyint NULL DEFAULT 0,
	N21 tinyint NULL DEFAULT 0,
	N22 tinyint NULL DEFAULT 0,
	N23 tinyint NULL DEFAULT 0,
	N24 tinyint NULL DEFAULT 0,
	N25 tinyint NULL DEFAULT 0,
	N26 tinyint NULL DEFAULT 0,
	N27 tinyint NULL DEFAULT 0,
	N28 tinyint NULL DEFAULT 0,
	N29 tinyint NULL DEFAULT 0,
	N30 tinyint NULL DEFAULT 0,
	N31 tinyint NULL DEFAULT 0,
)

GO
CREATE TABLE BAN(
	MABAN VARCHAR(5) NOT NULL PRIMARY KEY,
	TENBAN NVARCHAR(10) NOT NULL,
	TRANGTHAI NVARCHAR(100) NOT NULL DEFAULT N'TRỐNG'
)

GO
CREATE TABLE NHACUNGCAP(
	MANCC VARCHAR(10) NOT NULL PRIMARY KEY,
	TENNCC NVARCHAR(100) NOT NULL,
	DIACHINCC NVARCHAR(100) NOT NULL,
	DIENTHOAINCC VARCHAR(11) NOT NULL,
)

GO
CREATE TABLE PHIEUNHAP(
	MASONHAP VARCHAR(10) NOT NULL PRIMARY KEY,
	NGAYNHAP DATETIME NOT NULL,
	MANV VARCHAR(10) NULL FOREIGN KEY REFERENCES NHANVIEN(MANV) ON DELETE SET NULL
)

GO
CREATE TABLE MATHANG(
	MAHANG VARCHAR(10) NOT NULL PRIMARY KEY,
	TENHANG NVARCHAR(30) NOT NULL,
	MANCC VARCHAR(10) NOT NULL FOREIGN KEY REFERENCES NHACUNGCAP(MANCC) ON DELETE CASCADE
)

GO 
CREATE TABLE PHIEUNHAP_MATHANG(
	MASONHAP VARCHAR(10) NOT NULL,
	MAHANG VARCHAR(10) NOT NULL,
	GIAHANGNHAP MONEY NOT NULL,
	SOLUONGNHAP INT NOT  NULL
	PRIMARY KEY(MASONHAP,MAHANG),
	CONSTRAINT FK_CT_MH_ FOREIGN KEY (MAHANG) REFERENCES MATHANG(MAHANG) ON DELETE CASCADE,
	CONSTRAINT FK_PN_CT_ FOREIGN KEY (MASONHAP) REFERENCES PHIEUNHAP(MASONHAP) ON DELETE CASCADE
)

GO
CREATE TABLE SANPHAM(
	MASP VARCHAR(10) NOT NULL PRIMARY KEY,
	TENSP NVARCHAR(100) NOT NULL,
	DONGIABAN MONEY NOT NULL,
	GHICHU NVARCHAR(50) NULL DEFAULT N'ĐANG BÁN'
)


GO
CREATE TABLE HOADON(
	MAHOADON VARCHAR(20) NOT NULL PRIMARY KEY,
	NGAYNHAP DATETIME NULL,
	NGAYXUAT DATETIME NULL,
	MACA VARCHAR(2) NULL FOREIGN KEY (MACA) REFERENCES CA(MACA),
	THUNGAN VARCHAR(10) NULL FOREIGN KEY REFERENCES NHANVIEN(MANV) ON DELETE SET NULL,
	MABAN VARCHAR(5) NULL FOREIGN KEY REFERENCES BAN(MABAN) ON DELETE SET NULL,
	GIAMGIA FLOAT NULL default 0,
	VAT FLOAT NULL default 0,
	THANHTOAN MONEY NULL,
	GHICHU NVARCHAR(1000) NULL
)


GO
CREATE TABLE HOADONCHITIET(
	MAHOADON VARCHAR(20) NOT NULL,
	MASP VARCHAR(10) NOT NULL,
	SOLUONG INT NOT NULL,
	PRIMARY KEY (MAHOADON, MASP),
	CONSTRAINT FK_HDCT_HD FOREIGN KEY (MAHOADON) REFERENCES HOADON(MAHOADON) ON DELETE CASCADE,
	CONSTRAINT FK_HDCT_SP FOREIGN KEY (MASP) REFERENCES SANPHAM(MASP) ON DELETE CASCADE
)

--NHẬP DỮ LIỆU TỪNG BẢNG

GO
INSERT INTO CHUCVU(MACHUCVU, TENCHUCVU)
VALUES('AD', 'ADMIN')
INSERT INTO CHUCVU(MACHUCVU, TENCHUCVU)
VALUES('QL', N'QUẢN LÝ')
INSERT INTO CHUCVU(MACHUCVU, TENCHUCVU)
VALUES('TN', N'THU NGÂN')
INSERT INTO CHUCVU(MACHUCVU, TENCHUCVU)
VALUES('PV', N'PHỤC VỤ')
INSERT INTO CHUCVU(MACHUCVU, TENCHUCVU)
VALUES('PC', N'PHA CHẾ')
INSERT INTO CHUCVU(MACHUCVU, TENCHUCVU)
VALUES('GX', N'GIỮ XE')

GO
INSERT INTO CA(MACA, TENCA)
VALUES('S', N'SÁNG')
INSERT INTO CA(MACA, TENCA)
VALUES('C', N'CHIỀU')
INSERT INTO CA(MACA, TENCA)
VALUES('T', N'TỐI')


GO
INSERT INTO NHANVIEN(MANV, TENNV, NGAYSINH, GIOITINH, DIACHI, DIENTHOAI, MATKHAU, LUONGCOBAN, MACHUCVU, NGAYVAOLAM, MACA)
VALUES ('NV0001', N'TRẦN THANH AN', '11/11/1997', N'Nam', 'Diên Khánh, Khánh Hòa', '0122345678', '21232F297A57A5A743894A0E4A801FC3', '3000000', 'AD', '07/07/2018', 'S')
INSERT INTO NHANVIEN(MANV, TENNV, NGAYSINH, GIOITINH, DIACHI, DIENTHOAI, MATKHAU, LUONGCOBAN, MACHUCVU, NGAYVAOLAM, MACA)
VALUES ('NV0002', N'VŨ THỊ THƯƠNG', '12/01/1997', N'Nữ', 'Thanh An, Gia Lai', '01686276171', 'C4CA4238A0B923820DCC509A6F75849B', '4500000', 'AD', '07/07/2018', 'S')
INSERT INTO NHANVIEN(MANV, TENNV, NGAYSINH, GIOITINH, DIACHI, DIENTHOAI, MATKHAU, LUONGCOBAN, MACHUCVU, NGAYVAOLAM, MACA)
VALUES ('NV0003', N'HUỲNH PHƯƠNG NGỌC', '09/08/1997', N'Nữ', 'Nha Trang, Khánh Hòa', '01663450987', 'C4CA4238A0B923820DCC509A6F75849B', '4500000', 'TN', '07/07/2018', 'S')
INSERT INTO NHANVIEN(MANV, TENNV, NGAYSINH, GIOITINH, DIACHI, DIENTHOAI, MATKHAU, LUONGCOBAN, MACHUCVU, NGAYVAOLAM, MACA)
VALUES ('NV0004', N'NGUYỄN THỊ NGÂN', '03/12/1997', N'Nữ', 'Nha Trang, Khánh Hòa', '0972456722', 'C4CA4238A0B923820DCC509A6F75849B', '6000000', 'PV', '07/07/2018', 'C')
INSERT INTO NHANVIEN(MANV, TENNV, NGAYSINH, GIOITINH, DIACHI, DIENTHOAI, MATKHAU, LUONGCOBAN, MACHUCVU, NGAYVAOLAM, MACA)
VALUES ('NV0005', N'LÊ MINH QUANG', '06/22/1997', N'Nam', 'Nha Trang, Khánh Hòa', '0122356321', 'C4CA4238A0B923820DCC509A6F75849B', '3000000', 'PV', '07/07/2018', 'C')

GO
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('01', N'BÀN 1')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('02', N'BÀN 2')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('03', N'BÀN 3')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('04', N'BÀN 4')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('05', N'BÀN 5')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('06', N'BÀN 6')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('07', N'BÀN 7')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('08', N'BÀN 8')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('09', N'BÀN 9')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('10', N'BÀN 10')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('11', N'BÀN 11')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('12', N'BÀN 12')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('13', N'BÀN 13')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('14', N'BÀN 14')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('15', N'BÀN 15')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('16', N'BÀN 16')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('17', N'BÀN 17')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('18', N'BÀN 18')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('19', N'BÀN 19')
INSERT INTO BAN(MABAN, TENBAN)
VALUES ('20', N'BÀN 20')

GO
INSERT INTO NHACUNGCAP(MANCC, TENNCC, DIACHINCC, DIENTHOAINCC)
VALUES ('CC0001', 'ME TRANG', 'DA NANG - VIET NAM', '01686276171')
INSERT INTO NHACUNGCAP(MANCC, TENNCC, DIACHINCC, DIENTHOAINCC)
VALUES ('CC0002', 'HOANG DONG', 'HA NOI - VIET NAM', '0165234977')
INSERT INTO NHACUNGCAP(MANCC, TENNCC, DIACHINCC, DIENTHOAINCC)
VALUES ('CC0003', 'NGOC & LIEN', 'HO CHI MINH - VIET NAM', '0974024571')
INSERT INTO NHACUNGCAP(MANCC, TENNCC, DIACHINCC, DIENTHOAINCC)
VALUES ('CC0004', 'TRUNG NGUYEN', 'DAKLAK - VIET NAM', '0122345634')
INSERT INTO NHACUNGCAP(MANCC, TENNCC, DIACHINCC, DIENTHOAINCC)
VALUES ('CC0005', 'TIEN MINH', 'HO CHI MINH - VIET NAM', '01687723451')

GO
INSERT INTO MATHANG(MAHANG, TENHANG, MANCC)
VALUES ('MH0001', N'CAFE XÂY', 'CC0005')
INSERT INTO MATHANG(MAHANG, TENHANG, MANCC)
VALUES ('MH0002', 'CAFE RANG', 'CC0002')
INSERT INTO MATHANG(MAHANG, TENHANG, MANCC)
VALUES ('MH0003', N'CÀ CHUA', 'CC0002')
INSERT INTO MATHANG(MAHANG, TENHANG, MANCC)
VALUES ('MH0004', N'DÂU', 'CC0001')
INSERT INTO MATHANG(MAHANG, TENHANG, MANCC)
VALUES ('MH0005', N'NHO ĐEN', 'CC0003')
INSERT INTO MATHANG(MAHANG, TENHANG, MANCC)
VALUES ('MH0006', N'SỮA ĐẶC', 'CC0004')


GO
INSERT INTO SANPHAM(MASP, TENSP, DONGIABAN)
VALUES ('SP0001', N'CAFE ĐEN', '20000')
INSERT INTO SANPHAM(MASP, TENSP, DONGIABAN)
VALUES ('SP0002', N'NƯỚC CAM VẮT', '35000')
INSERT INTO SANPHAM(MASP, TENSP, DONGIABAN)
VALUES ('SP0003', N'SINH TỐ DÂU', '40000')
INSERT INTO SANPHAM(MASP, TENSP, DONGIABAN)
VALUES ('SP0004', N'MATCHA SỮA ĐÁ', '45000')
INSERT INTO SANPHAM(MASP, TENSP, DONGIABAN)
VALUES ('SP0005', N'CACAO NÓNG', '30000')